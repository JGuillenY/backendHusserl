var todosPasajes=[],nuevoPasaje={ref_id:"",ref_def_de:"",ref_def_es:"",ref_libro_de:"",ref_libro_es:""},newPasaje=()=>{$$pasajeView.setState("option","nuevo"),$$pasajeView.setState("expresionSeleccionada",nuevoPasaje),$(".expresion-selected").removeClass("expresion-selected"),$("textarea#mainEditar").val(nuevoPasaje.ref_def_de),$("textarea#mainDEditar").val(nuevoPasaje.ref_def_es),$("textarea#mainEditar").ckeditor(),$("textarea#mainDEditar").ckeditor(),$("#ref_id").prop("disabled",!1),$(".pasaje-login").hide()},deletePasaje=()=>{confirm("¿Está seguro de querer eliminar el pasaje seleccionado?")&&(console.log($$pasajeView.getState().expresionSeleccionada),adminService("/referencias/buscarPasaje/"+$$pasajeView.getState().expresionSeleccionada.ref_id,"GET",{},e=>{e.error?createAlert("Error: ",e.error):e.response.length>0?alert("Este pasaje está relacionado con expresiones del diccionario. Por favor, elimine dichas relaciones antes de continuar."):(console.log($$pasajeView.getState().expresionSeleccionada),adminService("/referencias/eliminarPasaje/"+$$pasajeView.getState().expresionSeleccionada.ref_id,"DELETE",{},a=>{e.error?createAlert("Error: ",e.error):(console.log(a),location.reload())}))}))},init=()=>{$("div#expresiones").html('    <div id="loading">        <img src="images/Facebook-1s-200px.gif">    </div>'),adminService("/referencias/lista","GET",{},e=>{e.error?createAlert("Error: ",e.error):(todosPasajes=e.response,$$alfabetoView.setState("expresiones",e.response),$$alfabetoView.selectExpresion(e.response[0]))})},toggleArrow=e=>{$(e).children("i").hasClass("fa-angle-down")?($(e).children("i").removeClass("fa-angle-down"),$(e).children("i").addClass("fa-angle-up")):($(e).children("i").removeClass("fa-angle-up"),$(e).children("i").addClass("fa-angle-down"))},guardar=()=>{var e="";e="nuevo"==$$pasajeView.getState().option?"/referencias/new/nuevoPasaje":"/referencias/editarPasaje/"+$$pasajeView.getState().expresionSeleccionada.ref_id;var a={ref_id:btoa($("ref_id").val()).toString(),pasaje_de:btoa($("#mainEditar").val()).toString(),ref_de:btoa($("#ref_libro_de").val()).toString(),pasaje_es:btoa($("#mainDEditar").val()).toString(),ref_es:btoa($("#ref_libro_es").val()).toString(),clave:$("#clave").val()};adminService(e,"POST",JSON.stringify(a),e=>{console.log(e),502==e.status?alert("El id que intenta guardar ya existe."):(alert("Se ha guardado correctamente."),"nuevo"==$$pasajeView.getState().option&&location.reload())})},$$menuView=$("#menu-view").view({state:{}}),$$alfabetoView=$("div#alfabeto-view").view({state:{opcionSeleccionada:"",expresiones:[]},selectExpresion:function(e){$$pasajeView.setState("expresionSeleccionada",e),$(".expresion-selected").removeClass("expresion-selected"),$$pasajeView.setState("option","editar"),$("#expresion"+e.ref_id).addClass("expresion-selected");var a="/referencias/"+e.ref_id;adminService(a,"GET",{},e=>{$("textarea#mainEditar").val(e.response[0].ref_def_de),$("textarea#mainDEditar").val(e.response[0].ref_def_es),$("#clave").val(e.response[0].clave),$("#clave_es").val(e.response[0].clave),$("textarea#mainEditar").ckeditor(),$("textarea#mainDEditar").ckeditor(),$("#ref_id").prop("disabled",!0),$(".pasaje-login").hide()})}}),$$pasajeView=$("div#pasaje-view").view({state:{option:"",pasaje_seleccionado:{},lang:"de",posicion_seleccionada:0,expresionSeleccionada:{},referencias:[]}});init();var togglepart=function(e){$("#"+e).hasClass("fa-plus")?($("#"+e).removeClass("fa-plus"),$("#"+e).addClass("fa-minus")):($("#"+e).removeClass("fa-minus"),$("#"+e).addClass("fa-plus"))},aplicaBusqueda=()=>{var e=$("#busqueda").val();for(var a in console.log(aplicaBusqueda),$(".hidden").removeClass("hidden"),todosPasajes){(todosPasajes[a].ref_id+" "+todosPasajes[a].ref_libro_de+" "+todosPasajes[a].ref_libro_es).includes(e)||$("#pasaje"+todosPasajes[a].ref_id).addClass("hidden")}$(".jerarq").tooltip()};$("document").ready(function(){$("#main-content").show()});