var todosTerminos=[],pasajeLang="de",mainView=!0,toggleMainView=()=>{$("div#pasaje-view").hasClass("smallHide")?($("div#alfabeto-view").addClass("smallHide"),$("nav#side-view").addClass("smallHide"),$("div#pasaje-view").removeClass("smallHide"),mainView=!0):($("div#alfabeto-view").removeClass("smallHide"),$("nav#side-view").removeClass("smallHide"),$("div#pasaje-view").addClass("smallHide"),mainView=!1)},$$menuView=$("#indicem").view({state:{opciones:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],opcionSeleccionada:"A"},selectLetter:function(e){localStore.setItem("letter",e),this.setState("opcionSeleccionada",e),$$alfabetoView.setState("opcionSeleccionada",e),getPalabras(e),$("#busqueda").val("")}}),getHier=(e,a)=>{var s="/expresiones/"+localStore.getItem("sublang")+"/hijosList/"+e;webService(s,"GET",{},s=>{var l="/expresiones/"+localStore.getItem("sublang")+"/abuelosList/"+e;webService(l,"GET",{},e=>{$$hierView.setState("openH",{abuelos:e.response,hijos:s.response,expresion:a}),0==$("#jerarquia-part").hasClass("show")&&(document.getElementById("jerarqplus").click(),document.getElementById("ultimasplus").click()),$('[data-toggle="tooltip"]').tooltip("hide")})})},getPalabras=e=>{"#"==e&&(e="todos");var a="/expresiones/"+localStore.getItem("sublang")+"/"+e;$("div#expresiones").html('    <div id="loading">        <img src="images/Facebook-1s-200px.gif">    </div>    '),webService(a,"GET",{},e=>{if(e.error)createAlert("Error: ",e.error);else{$("div#expresiones").html(""),todosTerminos=e.response;var a=0,s="",l="";for(var o in e.response){if(s="","es"==localStore.getItem("sublang"))var i=e.response[o].traduccion.replace(/\s+/g,"");else i=e.response[o].expresion.replace(/\s+/g,"");e.response[o].id!=a&&(o>0&&(c+="                                    </ul>                                </div>                            </div>                        </div>"),a=e.response[o].id,s='                        <div class="card" id="card-'+e.response[o].id+'">',e.response[o].id==localStore.getObjects("pasajeActual").id?s+='<div class="card-header selected" id="heading'+e.response[o].id+'">':s+='<div class="card-header" id="heading'+e.response[o].id+'">',s+='<h6 class="mb-0 row" style="font-size:.8em;">                        <a href="#" style="color:black;" class="col-10" onclick="refreshPasaje(\''+e.response[o].id+"', '"+window.btoa(e.response[o].expresion)+"','"+e.response[o].referencia_original+"', '"+e.response[o].refid+"')\">"+e.response[o].pretty_e+" // "+e.response[o].pretty_t+'</a>                        <a class="arrowdown col-2" href="#" onclick="toggleArrow(this)" data-toggle="collapse" data-target="#collapse'+e.response[o].id+'" aria-expanded="true" aria-controls="collapse'+e.response[o].id+'"><i class="fas fa-angle-down"></i></a>                    </h6>                    </div>                    <div id="collapse'+e.response[o].id+'" class="collapse" aria-labelledby="heading'+e.response[o].id+'">                        <div class="card-body">                            <ul id="referenciasList-'+e.response[o].id+'" style="padding-left: 15px;">',null!=e.response[o].refid?1==e.response[o].orden?s+='                            <a id="ref'+e.response[o].refid+i+'" href="#" class="referencias1" onclick="refreshPasaje(\''+e.response[o].id+"','"+window.btoa(e.response[o].expresion)+"','"+e.response[o].referencia_original+" ', '"+e.response[o].refid+"')\">"+e.response[o].referencia_original+" // "+e.response[o].referencia_traduccion+" {"+e.response[o].refid+"}</a>                            <br/>":s+='                            <a id="ref'+e.response[o].refid+i+'" href="#" class="referencias2" onclick="refreshPasaje(\''+e.response[o].id+"','"+window.btoa(e.response[o].expresion)+"','"+e.response[o].referencia_original+"', '"+e.response[o].refid+"')\">"+e.response[o].referencia_original+" // "+e.response[o].referencia_traduccion+" {"+e.response[o].refid+"}</a>                            <br/>":s+='<a class="referencias2">No hay ninguna referencia para esta expresión.</a>',l+=s)}document.getElementById("expresiones").innerHTML=l,$("div.card-header.selected h6 a.arrowdown").click(),"es"==localStore.getItem("sublang")?$("#toes2").hide():$("#tode2").hide(),getTo("card-"+localStore.getObjects("pasajeActual").id)}})},changeLang=e=>{$("#toes2").toggle(),$("#tode2").toggle(),$(".lang").tooltip("hide"),localStore.setItem("sublang",e),getPalabras(localStore.getItem("letter"))},toggleArrow=e=>{$(e).children("i").hasClass("fa-angle-down")?($(e).children("i").removeClass("fa-angle-down"),$(e).children("i").addClass("fa-angle-up")):($(e).children("i").removeClass("fa-angle-up"),$(e).children("i").addClass("fa-angle-down"))},$$alfabetoView=($$menuView=$("#menu-view").view({state:{opciones:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},selectLetter:function(e){localStore.setItem("letter",e),$$alfabetoView.setState("opcionSeleccionada",e),getPalabras(e)}}),$("div#alfabeto-view").view({state:{opcionSeleccionada:"",expresiones:[],currentLang:"es"}})),$$pasajeView=$("div#pasaje-view").view({state:{lista_pasajes:[],pasaje_seleccionado:{},lang:"de",posicion_seleccionada:0},changeLang:function(e){localStore.setObject("pasajeLang",e),"es"==e?($("#tode").show(),$("#toes").hide(),$("#closed-pasajes div.pasaje-original").hide(),$("#closed-pasajes div.pasaje-traduccion").show()):($("#tode").hide(),$("#toes").show(),$("#closed-pasajes div.pasaje-original").show(),$("#closed-pasajes div.pasaje-traduccion").hide()),$('[data-toggle="tooltip"]').tooltip("hide")}}),descargarRef=()=>{$('[data-toggle="tooltip"]').tooltip("hide"),$("#download-modal").modal("show")},$$hierView=$("div#hierarchy-view").view({state:{openH:{abuelos:[],hijos:[],expresion:""}},goToPasage:function(e){var a=e.expresion.slice(0,1);localStore.setItem("letter",a)}}),topasajewtid=(e,a)=>{webService("/referencias/obtieneReferenciasByTerm/"+e,"GET",{},e=>{localStore.setItem("letter",a),"es"==localStore.getItem("sublang")?toPasaje(e.response[0].id,window.btoa(e.response[0].expresion_traduccion),e.response[0].ref_original,e.response[0].refid):toPasaje(e.response[0].id,window.btoa(e.response[0].expresion_original),e.response[0].ref_original,e.response[0].refid)})},topasajewid=e=>{webService("/referencias/obtieneReferenciasByRef/"+e,"GET",{},e=>{toPasaje(e.response[0].id,window.btoa(e.response[0].expresion_original),e.response[0].ref_original,e.response[0].refid)})},getInitial=e=>{if("."==e[0])var a=e.slice(4,5);else if("'"==e[0])a=e.slice(1,2);else a=e.slice(0,1);switch(a){case"á":case"ä":case"Á":case"Ä":a="A";break;case"é":case"Ë":case"É":case"Ë":a="E";break;case"í":case"ï":case"Í":case"Ï":a="I";break;case"ó":case"ö":case"Ó":case"Ö":a="O";break;case"ú":case"ü":case"Ú":case"Ü":a="U";break;default:a=a.toUpperCase()}return a},toPasaje=(e,a,s,l)=>{var o=localStore.getObjects("sesion").ultimasVisitadas;o.push({id:e,expresion:window.atob(a),referencia:s,refid:l});var i={id:e,expresion:window.atob(a),referencia:s,refid:l};localStore.setObjects("pasajeActual",i);var t=localStore.getObjects("sesion");t.ultimasVisitadas=o,localStore.setObjects("sesion",t),$$ultimosView.setState("ultimasVisitadas",o.reverse()),changeView("pasajes")},refreshPasaje=(e,a,s,l)=>{if(null!=l){var o=localStore.getObjects("sesion").ultimasVisitadas;o.push({id:e,expresion:window.atob(a),referencia:s,refid:l});var i={id:e,expresion:window.atob(a),referencia:s,refid:l};localStore.setObjects("pasajeActual",i);var t=localStore.getObjects("sesion");t.ultimasVisitadas=o,localStore.setObjects("sesion",t),$$ultimosView.setState("ultimasVisitadas",o.reverse()),service="/referencias/obtieneReferencias/"+localStore.getObjects("pasajeActual").id,webService(service,"GET",{},e=>{for(var a in getHier(localStore.getObjects("pasajeActual").id,localStore.getObjects("pasajeActual").expresion),$$pasajeView.setState("lista_pasajes",e.response),e.response)if(e.response[a].refid==localStore.getObjects("pasajeActual").refid){var s=a;selectPasaje(a),$("a.left-arrowL").hasClass("open")&&$("a.right-arrowL").hasClass("open")||($("#langs").hide(),$("#closed-pasajes").removeClass("open"),$("#closed-pasajes").addClass("closed"),$("#open-pasajes").addClass("open"),$("#open-pasajes").removeClass("closed"))}if($('[data-toggle="tooltip"]').tooltip(),$(".selected").removeClass("selected"),$("#heading"+localStore.getObjects("pasajeActual").id).addClass("selected"),"es"==localStore.getItem("sublang"))var l=e.response[s].expresion_traduccion.replace(/\s+/g,"");else l=e.response[s].expresion_original.replace(/\s+/g,"");$("#ref"+e.response[s].refid+l).addClass("visited"),$(".smallView").removeClass("smallView"),mainView?($("div#alfabeto-view").removeClass("smallHide"),$("nav#side-view").removeClass("smallHide"),$("div#pasaje-view").addClass("smallHide")):($("div#alfabeto-view").addClass("smallHide"),$("nav#side-view").addClass("smallHide"),$("div#pasaje-view").removeClass("smallHide")),repaint()})}else alert("No hay ninguna referencia ligada a esta expresión.")},$$ultimosView=$("div#ultimos-view").view({state:{ultimasVisitadas:localStore.getObjects("sesion").ultimasVisitadas.reverse()},goToPasage:function(e){var a=getInitial(e.expresion);localStore.setItem("letter",a),toPasaje(e.id,window.btoa(e.expresion),e.referencia,e.refid)}}),selectPosicion=e=>{selectPasaje(e)},sigPosicion=e=>{selectPasaje(e+1)},antPosicion=e=>{selectPasaje(e-1)},repaint=()=>{var e=parseInt($$pasajeView.getState().posicion_seleccionada),a=$$pasajeView.getState().lista_pasajes,s='    <nav aria-label="Page navigation example">    <ul class="pagination justify-content-center" style="margin: 0;">';s+='<li class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[0].ref_original+'">',s+='        <a class="page-link" href="#" onclick="selectPasaje(0)" tabindex="-1"><i class="fas fa-angle-double-left"></i></a>        </li>',s+=0==e?'<li class="page-item disabled">':'<li class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[e-1].ref_original+'">',s+='        <a class="page-link" href="#" onclick="antPosicion('+e+')" tabindex="-1"><i class="fas fa-angle-left"></i></a>        </li>';var l=1,o=0,i=0;if(a.length>5){e-2>=0?o=2:e-1==0&&(o=1),e+2<a.length?i=2:e+1<a.length?(i=1,o+=1):o+=2;for(var t=e-o;t<e;t++)l=1+parseInt(t),s+='                        <li id="pos'+t+'" onclick="selectPosicion('+t+')" class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[t].ref_original+'"><a class="page-link" href="#">'+l+"</a></li>";l=1+parseInt(e),s+='                    <li id="pos'+e+'" onclick="selectPosicion('+e+')" class="page-item selected" data-toggle="tooltip" data-placement="top" title="'+a[e].ref_original+'"><a class="page-link" href="#">'+l+"</a></li>                    ";for(var r=parseInt(e)+1;r<=parseInt(e)+i;r++)l=1+parseInt(r),s+='                        <li id="pos'+r+'" onclick="selectPosicion('+r+')" class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[r].ref_original+'"><a class="page-link" href="#">'+l+"</a></li>                        "}else for(var n in a)l=1+parseInt(n),s+=n==e?'                        <li id="pos'+n+'" onclick="selectPosicion('+n+')" class="page-item selected" data-toggle="tooltip" data-placement="top" title="'+a[n].ref_original+'"><a class="page-link" href="#">'+l+"</a></li>                        ":'                        <li id="pos'+n+'" onclick="selectPosicion('+n+')" class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[n].ref_original+'"><a class="page-link" href="#">'+l+"</a></li>                        ";var d=a.length-1;s+=e==d?'<li class="page-item disabled">':'<li class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[parseInt(e)+1].ref_original+'">',s+='            <a class="page-link" href="#" onclick="sigPosicion('+e+')" ><i class="fas fa-angle-right"></i></a>        </li>',s+='<li class="page-item" data-toggle="tooltip" data-placement="top" title="'+a[d].ref_original+'">',s+='        <a class="page-link" href="#" onclick="selectPasaje('+d+')" tabindex="-1"><i class="fas fa-angle-double-right"></i></a>        </li>        </ul>',1==a.length?s+='<small style="top: -5px;position: relative;left: 5px;"><span id="hay">Hay</span> '+a.length+' <span id="pasajeen">pasaje en total.</span></small>':s+='<small style="top: -5px;position: relative;left: 5px;"><span id="hay">Hay</span> '+a.length+' <span id="pasajesen">pasajes en total.</span></small>',s+="</nav>",$("#pagination").html(s),"es"==$$pasajeView.getState().lang?$("#closed-original div.pasaje-traduccion").hide():($("#closed-pasajes div.pasaje-traduccion").hide(),$("#tode").hide()),$(".page-item").tooltip(),$$pasajeView.changeLang(localStore.getObject("pasajeLang"))},selectPasaje=e=>{$('[data-toggle="tooltip"]').tooltip("hide"),localStore.setItem("refId",e),$$pasajeView.setState("posicion_seleccionada",e),$$pasajeView.setState("pasaje_seleccionado",$$pasajeView.getState().lista_pasajes[e]),repaint(),$(".pasaje-orig").html($$pasajeView.getState().lista_pasajes[e].pasaje_original),$(".pasaje-trad").html($$pasajeView.getState().lista_pasajes[e].pasaje_traduccion),$("a.left-arrowL").hasClass("open")&&$("a.right-arrowL").hasClass("open")||($("#langs").hide(),$("#closed-pasajes").removeClass("open"),$("#closed-pasajes").addClass("closed"),$("#open-pasajes").addClass("open"),$("#open-pasajes").removeClass("closed")),$("#ref"+$$pasajeView.getState().lista_pasajes[e].refid+$$pasajeView.getState().lista_pasajes[e].expresion_original).addClass("visited")};localStore.getItem("sublang")?$$alfabetoView.setState("lang",localStore.getItem("sublang")):localStore.setItem("sublang","al"),localStore.getItem("letter")?$$menuView.selectLetter(localStore.getItem("letter")):$$menuView.selectLetter("A"),localStore.getObjects("pasajeActual")?(service="/referencias/obtieneReferencias/"+localStore.getObjects("pasajeActual").id,webService(service,"GET",{},e=>{for(var a in getHier(localStore.getObjects("pasajeActual").id,localStore.getObjects("pasajeActual").expresion),$$pasajeView.setState("lista_pasajes",e.response),e.response)if(e.response[a].refid==localStore.getObjects("pasajeActual").refid){selectPasaje(a)}$('[data-toggle="tooltip"]').tooltip(),repaint(),"es"!=localStore.getItem("lang")&&chLang(localStore.getItem("lang")),$(".selected").removeClass(".selected"),$("#heading"+localStore.getObjects("pasajeActual").id).addClass(".selected")})):($$pasajeView.setState("pasaje_seleccionado",nuevoPasaje),$$pasajeView.setState("lista_pasajes",[nuevoPasaje]));var keep=0,hideNav=e=>{switch(e){case"left":$("a.left-arrowL").hasClass("open")?($("a.left-arrowL").removeClass("open"),$("a.left-arrowL").addClass("closed"),$("a.left-arrowL i").removeClass("fa-angle-left"),$("a.left-arrowL i").addClass("fa-angle-right"),$("div#indice").hide(),$("div#alfabeto-view").removeClass("col-sm-3"),$("#langs").hide(),$("#closed-pasajes").removeClass("open"),$("#closed-pasajes").hasClass("closed")||$("#closed-pasajes").addClass("closed"),$("#open-pasajes").hasClass("closed")||$("#open-pasajes").addClass("open"),$("#open-pasajes").removeClass("closed")):($("a.right-arrowL").hasClass("open")&&($("#langs").show(),$("#closed-pasajes").hasClass("open")||$("#closed-pasajes").addClass("open"),$("#closed-pasajes").removeClass("closed"),$("#open-pasajes").removeClass("open"),$("#open-pasajes").hasClass("closed")||$("#open-pasajes").addClass("closed")),$("a.left-arrowL").removeClass("closed"),$("a.left-arrowL").addClass("open"),$("a.left-arrowL i").removeClass("fa-angle-right"),$("a.left-arrowL i").addClass("fa-angle-left"),$("div#indice").show(),$("div#alfabeto-view").addClass("col-sm-3"));break;case"right":$("a.right-arrowL").hasClass("open")?($("#langs").hide(),$("a.right-arrowL").removeClass("open"),$("a.right-arrowL").addClass("closed"),$("a.right-arrowL i").removeClass("fa-angle-right"),$("a.right-arrowL i").addClass("fa-angle-left"),$("div.side-view-body").hide(),$("nav#side-view").removeClass("col-sm-3"),$("#closed-pasajes").removeClass("open"),$("#closed-pasajes").hasClass("closed")||$("#closed-pasajes").addClass("closed"),$("#open-pasajes").hasClass("open")||$("#open-pasajes").addClass("open"),$("#open-pasajes").removeClass("closed")):($("a.left-arrowL").hasClass("open")&&($("#langs").show(),$("#closed-pasajes").hasClass("open")||$("#closed-pasajes").addClass("open"),$("#closed-pasajes").removeClass("closed"),$("#open-pasajes").removeClass("open"),$("#open-pasajes").hasClass("closed")||$("#open-pasajes").addClass("closed")),$("a.right-arrowL").removeClass("closed"),$("a.right-arrowL").addClass("open"),$("a.right-arrowL i").removeClass("fa-angle-left"),$("a.right-arrowL i").addClass("fa-angle-right"),$("div.side-view-body").show(),$("nav#side-view").addClass("col-sm-3"));break;case"open-both":$("a.left-arrowL").hasClass("open")||hideNav("left"),$("a.left-arrowR").hasClass("open")||hideNav("right");break;case"close-both":$("a.left-arrowL").hasClass("open")&&hideNav("left"),$("a.left-arrowR").hasClass("open")&&hideNav("right")}},downloadFile=(e,a)=>{$("#toDownloadDiv").html("<a href='/files/"+e+"."+a+"' id='fileToDownload' download></a>")},modalView=$("div#modal-view").view({state:{},submitDw:function(e){e.preventDefault();var a=[];if(this.data["ev-aleman"]?a.push(1):a.push(0),this.data["ev-espaniol"]?a.push(1):a.push(0),this.data["rf-aleman"]?a.push(1):a.push(0),this.data["rf-espaniol"]?a.push(1):a.push(0),this.data["ps-aleman"]?a.push(1):a.push(0),this.data["ps-espaniol"]?a.push(1):a.push(0),this.data["jq-rf"]?a.push(1):a.push(0),this.data.opcionTexto){var s="/reporte/reporteText/"+localStore.getObjects("pasajeActual").id+"?expresion_aleman=1expresion_espaniol=1&referencia_aleman=1            &referencia_espaniol=1&pasaje_aleman="+a[4]+"&pasaje_espaniol="+a[5]+"&hierarchy="+a[6]+"&lang="+localStore.getItem("lang");webService(s,"GET",{},e=>{downloadFile(e.response,"txt"),$("#download-modal").modal("hide"),document.getElementById("fileToDownload").click()})}else{s="/reporte/reportepdf/"+localStore.getObjects("pasajeActual").id+"?expresion_aleman=1&expresion_espaniol=1&referencia_aleman=1            &referencia_espaniol=1&pasaje_aleman="+a[4]+"&pasaje_espaniol="+a[5]+"&hierarchy="+a[6]+"&lang="+localStore.getItem("lang");webService(s,"GET",{},e=>{downloadFile(e.response,"pdf"),$("#download-modal").modal("hide"),document.getElementById("fileToDownload").click()})}}});$("document").ready(function(){$("#sub-loading").hide(),$("#main-content").show(),localStore.getObject("pasajeLang")||localStore.setObject("pasajeLang","de"),$$pasajeView.changeLang(localStore.getObject("pasajeLang"))});var togglepart=e=>{$("#"+e).hasClass("fa-plus")?($("#"+e).removeClass("fa-plus"),$("#"+e).addClass("fa-minus")):($("#"+e).removeClass("fa-minus"),$("#"+e).addClass("fa-plus"))},aplicaBusqueda=()=>{var e=$("#busqueda").val();for(var a in $(".hidden").removeClass("hidden"),todosTerminos){(todosTerminos[a].expresion+" "+todosTerminos[a].traduccion).includes(e)||$("#heading"+todosTerminos[a].id).parent().addClass("hidden")}$(".jerarq").tooltip()};